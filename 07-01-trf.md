# Домашнее задание к занятию «Введение в Terraform» - Тимохин Максим

Цели задания

    Установить и настроить Terrafrom.
    Научиться использовать готовый код.

Чек-лист готовности к домашнему заданию

    Скачайте и установите актуальную версию Terraform >=1.4.X . Приложите скриншот вывода команды terraform --version.
    Скачайте на свой ПК этот git-репозиторий. Исходный код для выполнения задания расположен в директории 01/src.
    Убедитесь, что в вашей ОС установлен docker.
    Зарегистрируйте аккаунт на сайте https://hub.docker.com/, выполните команду docker login и введите логин, пароль.

![1](https://github.com/MrAgrippa/06-db/blob/main/img/07-01/1.JPG)

![2](https://github.com/MrAgrippa/06-db/blob/main/img/07-01/2.JPG)

## Задание 1

1. Перейдите в каталог src. Скачайте все необходимые зависимости, использованные в проекте.
2. Изучите файл .gitignore. В каком terraform-файле, согласно этому .gitignore, допустимо сохранить личную, секретную информацию?
   
       personal.auto.tfvars - позволяет именовать файлы с секретными переменными 
   
3. Выполните код проекта. Найдите в state-файле секретное содержимое созданного ресурса random_password, пришлите в качестве ответа конкретный ключ и его значение.

![3](https://github.com/MrAgrippa/06-db/blob/main/img/07-01/3.JPG)

![4](https://github.com/MrAgrippa/06-db/blob/main/img/07-01/4.JPG)

4. Раскомментируйте блок кода, примерно расположенный на строчках 29–42 файла main.tf. Выполните команду terraform validate. Объясните, в чём заключаются намеренно допущенные ошибки. Исправьте их.

![5](https://github.com/MrAgrippa/06-db/blob/main/img/07-01/5.JPG)

4.1. Error: Missing name for resource (Ошибка: Отсутствует имя для ресурса). Для решения проблемы нужно добавить имя "nginx".

4.2. Неверное имя ресурса 1nginx. Имя должно начинаться с буквы или подчеркивания и может содержать только буквы, цифры, подчеркивания и тире.

4.3. Также была обнружена ошибка несоответствия имени ресурса "random_string" и ошибка одного символа в генерации имени контейнера в строке  name  = "example_${random_password.random_string.resulT}".

Исправленный код файла main.tf:

![6](https://github.com/MrAgrippa/06-db/blob/main/img/07-01/6.JPG)
   
5. Выполните код. В качестве ответа приложите: исправленный фрагмент кода и вывод команды docker ps.

![7](https://github.com/MrAgrippa/06-db/blob/main/img/07-01/7.JPG)

6. Замените имя docker-контейнера в блоке кода на hello_world. Не перепутайте имя контейнера и имя образа. Мы всё ещё продолжаем использовать name = "nginx:latest". Выполните команду terraform apply -auto-approve. Объясните своими словами, в чём может быть опасность применения ключа -auto-approve. В качестве ответа дополнительно приложите вывод команды docker ps.

![8](https://github.com/MrAgrippa/06-db/blob/main/img/07-01/8.JPG)

Ключ -auto-approve (автоматическое подтверждение) является опцией, которая позволяет автоматически подтвердить все изменения, которые будут внесены при выполнении команды или сценария. Это может быть опасно по нескольким причинам:

- Нежелательные изменения: Если случайно указан ключ -auto-approve, то все изменения, которые вносятся, будут выполнены без возможности просмотра и подтверждения. Это означает, что даже если есть  ошибки или нежелательные воздействия, они все равно будут применены без возможности отменить или проверить данные изменения. Это может привести к нежелательным последствиям, таким как потеря данных или нарушение работы системы.

- Безопасность: Применение ключа -auto-approve может открыть возможность для злоумышленников использовать скрипты или команды, чтобы произвести неправомерные или опасные изменения в системе. Это может привести к нарушению безопасности, утечке данных или некорректной работе приложений.

- Невозможность контроля и отката изменений: Когда все изменения автоматически подтверждаются, становится сложно контролировать и откатывать изменения в случае проблем или ошибок. Если возникнут проблемы после применения изменений, будет крайне сложно понять, что именно произошло и как это исправить.

7. Уничтожьте созданные ресурсы с помощью terraform. Убедитесь, что все ресурсы удалены. Приложите содержимое файла terraform.tfstate.

![9](https://github.com/MrAgrippa/06-db/blob/main/img/07-01/9.JPG)

9. Объясните, почему при этом не был удалён docker-образ nginx:latest. Ответ обязательно подкрепите строчкой из документации terraform провайдера docker. (ищите в классификаторе resource docker_image )

Образ Docker является отдельным элементом, который может использоваться и другими контейнерами или настройками. Поэтому Terraform не предпринимает действий по удалению образа, поскольку это может нарушить другие зависимости или использования, которые могут быть связаны с данным образом.

В документации провайдера Docker в Terraform указано следующее:

"The Docker provider provides an automatic workflow for managing Docker images, containers, and Docker Compose applications."

"This provider currently requires the Docker daemon to be reachable via the Docker API."
